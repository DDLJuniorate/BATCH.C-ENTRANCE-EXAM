<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daughters of Divine Love Abakpa, Enugu.<br>2025/2026 Academic Session Batch C Entrance Examination</title>
  <style>
    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: #100669; 
      background-image: url(admissionposter.jpg);

      margin: 0; 
      padding: 0; 
      
    }
    .container { 
      max-width: 800px; 
      margin: auto; 
      background: #190466; 
      padding: 20px; 
      border-radius: 10px; 
      margin-top: 30px; 
      box-shadow: 0 0 10px rgba(148, 65, 65, 0.1);
      position: relative;

    }
    header { 
      text-align: center; 
      background: #3f51b5; 
      color: white; 
      padding: 20px; 
    }
    header h1 { 
      margin: 5px 0; 
      font-size: 20px; 
    }
    .question-container {
      margin-bottom: 20px;
      position: relative;
    }
    .question { 
      margin-bottom: 20px; 
    }
    .options label { 
      display: block; 
      margin-bottom: 5px; 
      padding: 8px;
      border-radius: 4px;
    }
    .options label:hover {
      background-color: #f0f0f0;
    }
    #timer { 
      font-weight: bold; 
      color: red; 
      text-align: right; 
      position: fixed;
      top: 10px;
      right: 10px;
      background: white;
      padding: 5px 10px;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    #webcam-container {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 150px;
      height: 100px;
      z-index: 1000;
      border: 2px solid #3f51b5;
      border-radius: 5px;
      overflow: hidden;
    }
    #webcam {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .hidden { 
      display: none; 
    }
    button { 
      padding: 10px 20px; 
      background: #3f51b5; 
      color: white; 
      border: none; 
      border-radius: 5px; 
      cursor: pointer; 
      margin-top: 15px; 
      font-size: 16px;
    }
    button:disabled { 
      background: gray; 
    }
    .result { 
      background: #e3f2fd; 
      padding: 20px; 
      margin-top: 20px; 
      border-left: 4px solid #2196f3; 
    }
    input[type="text"], select { 
      width: 100%; 
      padding: 10px; 
      margin: 10px 0; 
      font-size: 16px;
    }
    .progress-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      font-size: 14px;
      color: #555;
    }
    .question-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    .warning-alert {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ff4444;
      color: white;
      padding: 20px;
      border-radius: 5px;
      z-index: 2000;
      display: none;
      text-align: center;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    #noise-warning {
      background-color: #ff8800;
    }
    #tab-warning {
      background-color: #ff4444;
    }
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 15px;
      }
      #webcam-container {
        width: 100px;
        height: 80px;
      }
      #timer {
        font-size: 14px;
      }
      button {
        padding: 8px 16px;
        width: 100%;
        margin: 5px 0;
      }
      .question-nav {
        flex-direction: column;
      }
      .logo {
  width: 100%;
  max-width: 150px;
  height: auto;
  align-items: center;
}
    }
  </style>
</head>
<body>

<header>
    <img src="SCHOOL.jpg" alt="Logo" width="150", style="float:left;">
  <h1 style="font-size: 250%; color: #9ae709;">DAUGHTERS OF DIVINE LOVE JUNIORATE ABAKPA, ENUGU</h1>
  <p style="font-size: 150%;"><b>2025/2026 Academic Session Batch C Entrance Examination</p>
</header>

<div id="webcam-container" class="hidden">
  <video id="webcam" autoplay playsinline></video>
</div>

<div id="timer" class="hidden">Time Left: 1:00:00</div>

<div class="container" id="startScreen">
  <h3 style="color: #e8e7eb; text-align: center;">Student Information</h3>
  <p style="color: #f8f8fa;text-align: center;"><b>Make sure you have read the information carefully before starting the exam</p>
  <input type="text" id="studentName" placeholder="Full Name" required />
  <input type="text" id="studentClass" placeholder="Class Applying Into" required />
  <input type="text" id="studentPhone" placeholder="Phone Number" required />
  <button onclick="startExam()">Start Exam</button>
</div>

<div class="container hidden" id="examScreen">
  <div class="progress-container">
    <div id="progress-count">Question 1 of 70</div>
    <div id="answered-count">Answered: 0/70</div>
  </div>
  <form id="examForm", style="color: #d8e709;">
    <div id="questions-container">
      <!-- Questions will be dynamically inserted here -->
    </div>

    <div class="question-nav">
      <button type="button" id="prevBtn" onclick="navigateQuestion(-1)" disabled>Previous</button>
      <button type="button" id="nextBtn" onclick="navigateQuestion(1)">Next</button>
    </div>

    <button type="submit" id="submitBtn">Submit Exam</button>
  </form>

  <div class="result hidden" id="resultBox"></div>
  <button id="pdf-download" class="hidden" onclick="generatePDF()">Download Result as PDF</button>
</div>

<div class="warning-alert" id="noise-warning">
  <h3>Warning!</h3>
  <p>Excessive noise detected. Please maintain silence during the exam.</p>
  <button onclick="document.getElementById('noise-warning').style.display = 'none'">OK</button>
</div>

<div class="warning-alert" id="tab-warning">
  <h3>Warning!</h3>
  <p>Do not switch tabs or leave this page during the exam!</p>
  <button onclick="document.getElementById('tab-warning').style.display = 'none'">OK</button>
</div>

<!-- Libraries -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAG2INXGOyaxW6cewhM-uiYTvydkGvQRgc",
    authDomain: "ddl-exam-report.firebaseapp.com",
    projectId: "ddl-exam-report",
    storageBucket: "ddl-exam-report.appspot.com",
    messagingSenderId: "1060940461659",
    appId: "1:1060940461659:web:3afc9539da4cd81c3df17e",
    measurementId: "G-3BHGRDYCMH"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const { jsPDF } = window.jspdf;

  // Global variables
  let currentQuestionIndex = 0;
  let questions = [];
  let examResult = {};
  let timerInterval;
  let audioContext;
  let noiseMonitorInterval;
  let warningCount = 0;

  // Sample questions - replace with your actual questions
  
  const sampleQuestions = [
    // English Questions

    
  {
    id: "q_eng_1",
    subject: "English",
    type: "synonym",
    text: "1. Choose the correct synonym of happy.",
    options: [
      { value: "A", text: "Sad" },
      { value: "B", text: "Angry" },
      { value: "C", text: "Joyful" },
      { value: "D", text: "Quiet" }
    ]
  },
  {
    id: "q_eng_2",
    subject: "English",
    type: "verb_tense",
    text: "2. What is the past tense of go?",
    options: [
      { value: "A", text: "Goes" },
      { value: "B", text: "Gone" },
      { value: "C", text: "Going" },
      { value: "D", text: "Went" }
    ]
  },
  {
    id: "q_eng_3",
    subject: "English",
    type: "punctuation",
    text: "3. Which of these is a punctuation mark?",
    options: [
      { value: "A", text: "Comma" },
      { value: "B", text: "Bracket" },
      { value: "C", text: "Dash" },
      { value: "D", text: "All of the above" }
    ]
  },
  {
    id: "q_eng_4",
    subject: "English",
    type: "verb_usage",
    text: "4. The boy _____ a story before sleeping.",
    options: [
      { value: "A", text: "reads" },
      { value: "B", text: "read" },
      { value: "C", text: "reading" },
      { value: "D", text: "has read" }
    ]
  },
  {
    id: "q_eng_5",
    subject: "English",
    type: "grammar",
    text: "5. Choose the correct word: “The dog wagged ___ tail.”",
    options: [
      { value: "A", text: "it's" },
      { value: "B", text: "its" },
      { value: "C", text: "its'" },
      { value: "D", text: "it" }
    ]
  },
  {
    id: "q_eng_6",
    subject: "English",
    type: "comparative",
    text: "6. She is taller _____ her sister.",
    options: [
      { value: "A", text: "than" },
      { value: "B", text: "then" },
      { value: "C", text: "that" },
      { value: "D", text: "to" }
    ]
  },
  {
    id: "q_eng_7",
    subject: "English",
    type: "parts_of_speech",
    text: "7. Identify the adverb in the sentence: “He walked slowly.”",
    options: [
      { value: "A", text: "He" },
      { value: "B", text: "walked" },
      { value: "C", text: "slowly" },
      { value: "D", text: "None" }
    ]
  },
  {
    id: "q_eng_8",
    subject: "English",
    type: "parts_of_speech",
    text: "8. Which of these is a conjunction?",
    options: [
      { value: "A", text: "After" },
      { value: "B", text: "About" },
      { value: "C", text: "And" },
      { value: "D", text: "An" }
    ]
  },
  {
    id: "q_eng_9",
    subject: "English",
    type: "tense",
    text: "9. “They have been working since morning.” What is the tense?",
    options: [
      { value: "A", text: "Past" },
      { value: "B", text: "Present perfect" },
      { value: "C", text: "Present continuous" },
      { value: "D", text: "Present perfect continuous" }
    ]
  },
  {
    id: "q_eng_10",
    subject: "English",
    type: "opposite",
    text: "10. Choose the opposite of brave.",
    options: [
      { value: "A", text: "Shy" },
      { value: "B", text: "Cowardly" },
      { value: "C", text: "Fearful" },
      { value: "D", text: "Weak" }
    ]
  },
  {
    id: "q_eng_11",
    subject: "English",
    type: "grammar",
    text: "11. Which sentence is correct?",
    options: [
      { value: "A", text: "I doesn't know." },
      { value: "B", text: "He don't play." },
      { value: "C", text: "She doesn't eat meat." },
      { value: "D", text: "They doesn't sing." }
    ]
  },
  {
    id: "q_eng_12",
    subject: "English",
    type: "voice",
    text: "12. “Tunde plays the drum.” Change to passive.",
    options: [
      { value: "A", text: "The drum is played by Tunde." },
      { value: "B", text: "Tunde is playing the drum." },
      { value: "C", text: "The drum plays Tunde." },
      { value: "D", text: "Tunde was played by drum." }
    ]
  },
  {
    id: "q_eng_13",
    subject: "English",
    type: "question_tag",
    text: "13. Select the correct question tag: “You are happy, ___?”",
    options: [
      { value: "A", text: "aren’t you" },
      { value: "B", text: "is it" },
      { value: "C", text: "don’t you" },
      { value: "D", text: "are you" }
    ]
  },
  {
    id: "q_eng_14",
    subject: "English",
    type: "phonetics",
    text: "14. Choose the word with the same sound as bare:",
    options: [
      { value: "A", text: "beer" },
      { value: "B", text: "bar" },
      { value: "C", text: "bear" },
      { value: "D", text: "burr" }
    ]
  },
  {
    id: "q_eng_15",
    subject: "English",
    type: "reported_speech",
    text: "15. Change to reported speech: He said, “I will go.”",
    options: [
      { value: "A", text: "He says he would go." },
      { value: "B", text: "He said he will go." },
      { value: "C", text: "He said he would go." },
      { value: "D", text: "He said I would go." }
    ]
  },
  {
    id: "q_eng_16",
    subject: "English",
    type: "figure_of_speech",
    text: "16. What figure of speech is “He is as brave as a lion”?",
    options: [
      { value: "A", text: "Simile" },
      { value: "B", text: "Metaphor" },
      { value: "C", text: "Hyperbole" },
      { value: "D", text: "Irony" }
    ]
  },
  {
    id: "q_eng_17",
    subject: "English",
    type: "antonym",
    text: "17. Select the antonym of scarce.",
    options: [
      { value: "A", text: "Rare" },
      { value: "B", text: "Abundant" },
      { value: "C", text: "Few" },
      { value: "D", text: "Uncommon" }
    ]
  },
  {
    id: "q_eng_18",
    subject: "English",
    type: "punctuation",
    text: "18. Choose the correctly punctuated sentence.",
    options: [
      { value: "A", text: 'She said, "Come here".' },
      { value: "B", text: 'She said "Come here."' },
      { value: "C", text: 'She said, "Come here."' },
      { value: "D", text: 'She said "Come here' }
    ]
  },
  {
    id: "q_eng_19",
    subject: "English",
    type: "article",
    text: "19. Pick the correct article: “___ hour has passed.”",
    options: [
      { value: "A", text: "A" },
      { value: "B", text: "An" },
      { value: "C", text: "The" },
      { value: "D", text: "One" }
    ]
  },
  {
    id: "q_eng_20",
    subject: "English",
    type: "parts_of_speech",
    text: "20. Which of these is a noun?",
    options: [
      { value: "A", text: "Run" },
      { value: "B", text: "Book" },
      { value: "C", text: "Quickly" },
      { value: "D", text: "Beautiful" }
    ]
  },

    // Add more questions here...
    // Math Questions
    
    {
    id: "q_math_1",
    subject: "Mathematics",
    text: "1. What is the place value of 7 in 2376400?",
    options: [
      { value: "A", text: "70" },
      { value: "B", text: "700" },
      { value: "C", text: "7000" },
      { value: "D", text: "70,000" }
    ]
  },
  {
    id: "q_math_2",
    subject: "Mathematics",
    text: "2. Find the sum of 3.13, 4.171, 1.12, 2.02 and 6.069",
    options: [
      { value: "A", text: "16.01" },
      { value: "B", text: "16.15" },
      { value: "C", text: "16.51" },
      { value: "D", text: "16.391" }
    ]
  },
  {
    id: "q_math_3",
    subject: "Mathematics",
    text: "3. Simplify: 3/4 + 5/8 = ?",
    options: [
      { value: "A", text: "1" },
      { value: "B", text: "1 3/8" },
      { value: "C", text: "7/8" },
      { value: "D", text: "1 1/8" }
    ]
  },
  {
    id: "q_math_4",
    subject: "Mathematics",
    text: "4. What is the value of π (pi) approximately?",
    options: [
      { value: "A", text: "22/7" },
      { value: "B", text: "3.142" },
      { value: "C", text: "Both A and B" },
      { value: "D", text: "None" }
    ]
  },
  {
    id: "q_math_5",
    subject: "Mathematics",
    text: "5. 25% of 240 is",
    options: [
      { value: "A", text: "50" },
      { value: "B", text: "60" },
      { value: "C", text: "70" },
      { value: "D", text: "80" }
    ]
  },
  {
    id: "q_math_6",
    subject: "Mathematics",
    text: "6. A square has a side of 4 cm. Its area is",
    options: [
      { value: "A", text: "16 cm²" },
      { value: "B", text: "8 cm²" },
      { value: "C", text: "12 cm²" },
      { value: "D", text: "20 cm²" }
    ]
  },
  {
    id: "q_math_7",
    subject: "Mathematics",
    text: "7. Change 11001₂ to base 10.",
    options: [
      { value: "A", text: "25" },
      { value: "B", text: "27" },
      { value: "C", text: "19" },
      { value: "D", text: "15" }
    ]
  },
  {
    id: "q_math_8",
    subject: "Mathematics",
    text: "8. What is the next prime number after 23?",
    options: [
      { value: "A", text: "24" },
      { value: "B", text: "25" },
      { value: "C", text: "27" },
      { value: "D", text: "29" }
    ]
  },
  {
    id: "q_math_9",
    subject: "Mathematics",
    text: "9. A rectangle has length 6 cm and breadth 4 cm. What is its perimeter?",
    options: [
      { value: "A", text: "10 cm" },
      { value: "B", text: "12 cm" },
      { value: "C", text: "20 cm" },
      { value: "D", text: "24 cm" }
    ]
  },
  {
    id: "q_math_10",
    subject: "Mathematics",
    text: "10. Solve: (5 × 2) + 4²",
    options: [
      { value: "A", text: "18" },
      { value: "B", text: "26" },
      { value: "C", text: "21" },
      { value: "D", text: "36" }
    ]
  },
  {
    id: "q_math_11",
    subject: "Mathematics",
    text: "11. Find the LCM of 6, 8 and 12",
    options: [
      { value: "A", text: "24" },
      { value: "B", text: "48" },
      { value: "C", text: "36" },
      { value: "D", text: "72" }
    ]
  },
  {
    id: "q_math_12",
    subject: "Mathematics",
    text: "12. A boy is 4 years older than his brother. If he is 12, how old is his brother?",
    options: [
      { value: "A", text: "6" },
      { value: "B", text: "7" },
      { value: "C", text: "8" },
      { value: "D", text: "10" }
    ]
  },
  {
    id: "q_math_13",
    subject: "Mathematics",
    text: "13. What is 20% of 150?",
    options: [
      { value: "A", text: "15" },
      { value: "B", text: "20" },
      { value: "C", text: "30" },
      { value: "D", text: "25" }
    ]
  },
  {
    id: "q_math_14",
    subject: "Mathematics",
    text: "14. A triangle has angles 50°, 60°, what is the third angle?",
    options: [
      { value: "A", text: "70°" },
      { value: "B", text: "80°" },
      { value: "C", text: "90°" },
      { value: "D", text: "60°" }
    ]
  },
  {
    id: "q_math_15",
    subject: "Mathematics",
    text: "15. Write 0.75 as a fraction.",
    options: [
      { value: "A", text: "¾" },
      { value: "B", text: "7/10" },
      { value: "C", text: "3/5" },
      { value: "D", text: "1/4" }
    ]
  },
  {
    id: "q_math_16",
    subject: "Mathematics",
    text: "16. Round 78.456 to 1 decimal place.",
    options: [
      { value: "A", text: "78.5" },
      { value: "B", text: "78.4" },
      { value: "C", text: "78.45" },
      { value: "D", text: "78.46" }
    ]
  },
  {
    id: "q_math_17",
    subject: "Mathematics",
    text: "17. A man bought 5 oranges at ₦50 each. What is the total cost?",
    options: [
      { value: "A", text: "₦250" },
      { value: "B", text: "₦150" },
      { value: "C", text: "₦200" },
      { value: "D", text: "₦300" }
    ]
  },
  {
    id: "q_math_18",
    subject: "Mathematics",
    text: "18. Multiply: 0.3 × 0.4",
    options: [
      { value: "A", text: "0.07" },
      { value: "B", text: "0.12" },
      { value: "C", text: "0.15" },
      { value: "D", text: "1.2" }
    ]
  },
  {
    id: "q_math_19",
    subject: "Mathematics",
    text: "19. Solve: 16 ÷ (2 + 2)",
    options: [
      { value: "A", text: "2" },
      { value: "B", text: "4" },
      { value: "C", text: "8" },
      { value: "D", text: "16" }
    ]
  },
  {
    id: "q_math_20",
    subject: "Mathematics",
    text: "20. What is the square root of 144?",
    options: [
      { value: "A", text: "10" },
      { value: "B", text: "12" },
      { value: "C", text: "14" },
      { value: "D", text: "16" }
    ]
  },


    // General Paper Questions
      {
    id: "q_gp_1",
    subject: "General Paper",
    text: "1. The main source of energy on earth is",
    options: [
      { value: "A", text: "Moon" },
      { value: "B", text: "Sun" },
      { value: "C", text: "Fire" },
      { value: "D", text: "Stars" }
    ]
  },
  {
    id: "q_gp_2",
    subject: "General Paper",
    text: "2. Which organ pumps blood?",
    options: [
      { value: "A", text: "Kidney" },
      { value: "B", text: "Liver" },
      { value: "C", text: "Heart" },
      { value: "D", text: "Brain" }
    ]
  },
  {
    id: "q_gp_3",
    subject: "General Paper",
    text: "3. Boiling water changes into",
    options: [
      { value: "A", text: "Ice" },
      { value: "B", text: "Gas" },
      { value: "C", text: "Liquid" },
      { value: "D", text: "Solid" }
    ]
  },
  {
    id: "q_gp_4",
    subject: "General Paper",
    text: "4. The human skeleton provides",
    options: [
      { value: "A", text: "blood" },
      { value: "B", text: "movement" },
      { value: "C", text: "support" },
      { value: "D", text: "digestion" }
    ]
  },
  {
    id: "q_gp_5",
    subject: "General Paper",
    text: "5. Which disease is waterborne?",
    options: [
      { value: "A", text: "Malaria" },
      { value: "B", text: "Cholera" },
      { value: "C", text: "Measles" },
      { value: "D", text: "Tuberculosis" }
    ]
  },
  {
    id: "q_gp_6",
    subject: "General Paper",
    text: "6. A solution of acid and base is called",
    options: [
      { value: "A", text: "Mixture" },
      { value: "B", text: "Salt" },
      { value: "C", text: "Neutralization" },
      { value: "D", text: "Compound" }
    ]
  },
  {
    id: "q_gp_7",
    subject: "General Paper",
    text: "7. The sun is a",
    options: [
      { value: "A", text: "Moon" },
      { value: "B", text: "Planet" },
      { value: "C", text: "Star" },
      { value: "D", text: "Comet" }
    ]
  },
  {
    id: "q_gp_8",
    subject: "General Paper",
    text: "8. Smoking is harmful because of",
    options: [
      { value: "A", text: "protein" },
      { value: "B", text: "water" },
      { value: "C", text: "tobacco" },
      { value: "D", text: "salt" }
    ]
  },
  {
    id: "q_gp_9",
    subject: "General Paper",
    text: "9. A body in motion stays in motion unless stopped by",
    options: [
      { value: "A", text: "heat" },
      { value: "B", text: "light" },
      { value: "C", text: "force" },
      { value: "D", text: "motion" }
    ]
  },
  {
    id: "q_gp_10",
    subject: "General Paper",
    text: "10. Water freezes at",
    options: [
      { value: "A", text: "10°C" },
      { value: "B", text: "0°C" },
      { value: "C", text: "100°C" },
      { value: "D", text: "-10°C" }
    ]
  },
  {
    id: "q_gp_11",
    subject: "General Paper",
    text: "11. PC stands for",
    options: [
      { value: "A", text: "Private Computer" },
      { value: "B", text: "Personal Computer" },
      { value: "C", text: "Public Computer" },
      { value: "D", text: "People’s Computer" }
    ]
  },
  {
    id: "q_gp_12",
    subject: "General Paper",
    text: "12. SIM means",
    options: [
      { value: "A", text: "Static Input Module" },
      { value: "B", text: "Subscriber Identity Module" },
      { value: "C", text: "Single Internal Memory" },
      { value: "D", text: "System Information Mechanism" }
    ]
  },
  {
    id: "q_gp_13",
    subject: "General Paper",
    text: "13. Google Chrome is a",
    options: [
      { value: "A", text: "Spreadsheet" },
      { value: "B", text: "Word Processor" },
      { value: "C", text: "Browser" },
      { value: "D", text: "Operating System" }
    ]
  },
  {
    id: "q_gp_14",
    subject: "General Paper",
    text: "14. Which is not a computer device?",
    options: [
      { value: "A", text: "Mouse" },
      { value: "B", text: "Monitor" },
      { value: "C", text: "Chalk" },
      { value: "D", text: "Keyboard" }
    ]
  },
  {
    id: "q_gp_15",
    subject: "General Paper",
    text: "15. MS Word is a",
    options: [
      { value: "A", text: "Program" },
      { value: "B", text: "Virus" },
      { value: "C", text: "Mouse" },
      { value: "D", text: "Icon" }
    ]
  },
  {
    id: "q_gp_16",
    subject: "General Paper",
    text: "16. A computer virus is a",
    options: [
      { value: "A", text: "Hardware" },
      { value: "B", text: "Software" },
      { value: "C", text: "Malicious program" },
      { value: "D", text: "None" }
    ]
  },
  {
    id: "q_gp_17",
    subject: "General Paper",
    text: "17. Which of these stores data temporarily?",
    options: [
      { value: "A", text: "ROM" },
      { value: "B", text: "RAM" },
      { value: "C", text: "HDD" },
      { value: "D", text: "CPU" }
    ]
  },
  {
    id: "q_gp_18",
    subject: "General Paper",
    text: "18. To move a file is to",
    options: [
      { value: "A", text: "Delete" },
      { value: "B", text: "Save" },
      { value: "C", text: "Cut and paste" },
      { value: "D", text: "Copy" }
    ]
  },
  {
    id: "q_gp_19",
    subject: "General Paper",
    text: "19. An email is used to",
    options: [
      { value: "A", text: "Sing" },
      { value: "B", text: "Play games" },
      { value: "C", text: "Send messages" },
      { value: "D", text: "Browse TV" }
    ]
  },
  {
    id: "q_gp_20",
    subject: "General Paper",
    text: "20. An icon is a",
    options: [
      { value: "A", text: "Text" },
      { value: "B", text: "Picture symbol" },
      { value: "C", text: "Sound" },
      { value: "D", text: "Website" }
    ]
  },
  {
    id: "q_gp_21",
    subject: "General Paper",
    text: "21. The tool used to cut wood is",
    options: [
      { value: "A", text: "Saw" },
      { value: "B", text: "Hammer" },
      { value: "C", text: "File" },
      { value: "D", text: "Spanner" }
    ]
  },
  {
    id: "q_gp_22",
    subject: "General Paper",
    text: "22. A triangle used for drawing angles is",
    options: [
      { value: "A", text: "Compass" },
      { value: "B", text: "Divider" },
      { value: "C", text: "Set-square" },
      { value: "D", text: "Ruler" }
    ]
  },
  {
    id: "q_gp_23",
    subject: "General Paper",
    text: "23. Electrical energy can be changed to",
    options: [
      { value: "A", text: "Food" },
      { value: "B", text: "Sound" },
      { value: "C", text: "Heat" },
      { value: "D", text: "Both B & C" }
    ]
  },
  {
    id: "q_gp_24",
    subject: "General Paper",
    text: "24. Gears are used to",
    options: [
      { value: "A", text: "Join wood" },
      { value: "B", text: "Transmit motion" },
      { value: "C", text: "Store power" },
      { value: "D", text: "Direct water" }
    ]
  },
  {
    id: "q_gp_25",
    subject: "General Paper",
    text: "25. Which material is magnetic?",
    options: [
      { value: "A", text: "Wood" },
      { value: "B", text: "Rubber" },
      { value: "C", text: "Iron" },
      { value: "D", text: "Plastic" }
    ]
  },
  {
    id: "q_gp_26",
    subject: "General Paper",
    text: "26. Who betrayed Jesus Christ?",
    options: [
      { value: "A", text: "Peter" },
      { value: "B", text: "James" },
      { value: "C", text: "Judas" },
      { value: "D", text: "John" }
    ]
  },
  {
    id: "q_gp_27",
    subject: "General Paper",
    text: "27. The Bible is divided into",
    options: [
      { value: "A", text: "4 parts" },
      { value: "B", text: "2 parts" },
      { value: "C", text: "5 parts" },
      { value: "D", text: "3 parts" }
    ]
  },
  {
    id: "q_gp_28",
    subject: "General Paper",
    text: "28. Jesus was born in",
    options: [
      { value: "A", text: "Nazareth" },
      { value: "B", text: "Jerusalem" },
      { value: "C", text: "Bethlehem" },
      { value: "D", text: "Galilee" }
    ]
  },
  {
    id: "q_gp_29",
    subject: "General Paper",
    text: "29. The Ten Commandments were given to",
    options: [
      { value: "A", text: "Adam" },
      { value: "B", text: "Abraham" },
      { value: "C", text: "Moses" },
      { value: "D", text: "Jesus" }
    ]
  },
  {
    id: "q_gp_30",
    subject: "General Paper",
    text: "30. What is faith?",
    options: [
      { value: "A", text: "Hope in something seen" },
      { value: "B", text: "Confidence in the known" },
      { value: "C", text: "Belief in things not seen" },
      { value: "D", text: "Trust in people" }
    ]
  }
];


  // Correct answers - replace with your actual correct answers
  const correctAnswers = {
    q_eng_1: "C",
  q_eng_2: "D",
  q_eng_3: "D",
  q_eng_4: "A",
  q_eng_5: "B",
  q_eng_6: "A",
  q_eng_7: "C",
  q_eng_8: "C",
  q_eng_9: "D",
  q_eng_10: "B",
  q_eng_11: "C",
  q_eng_12: "A",
  q_eng_13: "A",
  q_eng_14: "C",
  q_eng_15: "C",
  q_eng_16: "A",
  q_eng_17: "B",
  q_eng_18: "C",
  q_eng_19: "B",
  q_eng_20: "B",

  q_math_1: "D",  // 70,000
  q_math_2: "C",  // 16.51
  q_math_3: "D",  // 1 1/8
  q_math_4: "C",  // Both A and B
  q_math_5: "B",  // 60
  q_math_6: "A",  // 16 cm²
  q_math_7: "C",  // 25
  q_math_8: "D",  // 29
  q_math_9: "D",  // 20 cm
  q_math_10: "B", // 26
  q_math_11: "A", // 24
  q_math_12: "C", // 8
  q_math_13: "C", // 30
  q_math_14: "A", // 70°
  q_math_15: "A", // ¾
  q_math_16: "A", // 78.5
  q_math_17: "A", // ₦250
  q_math_18: "B", // 0.12
  q_math_19: "B", // 4
  q_math_20: "B" , // 12
    
   q_gp_1: "B",
  q_gp_2: "C",
  q_gp_3: "B",
  q_gp_4: "C",
  q_gp_5: "B",
  q_gp_6: "C",
  q_gp_7: "C",
  q_gp_8: "C",
  q_gp_9: "C",
  q_gp_10: "B",
  q_gp_11: "B",
  q_gp_12: "B",
  q_gp_13: "C",
  q_gp_14: "C",
  q_gp_15: "A",
  q_gp_16: "C",
  q_gp_17: "B",
  q_gp_18: "C",
  q_gp_19: "C",
  q_gp_20: "B",
  q_gp_21: "A",
  q_gp_22: "C",
  q_gp_23: "D",
  q_gp_24: "B",
  q_gp_25: "C",
  q_gp_26: "C",
  q_gp_27: "B",
  q_gp_28: "C",
  q_gp_29: "C",
  q_gp_30: "C"
  };

  // Start exam function
  function startExam() {
    const name = document.getElementById("studentName").value.trim();
    const phone = document.getElementById("studentPhone").value.trim();
    const level = document.getElementById("studentClass").value.trim();
    
    if (!name || !phone || !level) {
      return alert("Please fill all fields");
    }
    
    document.getElementById("startScreen").classList.add("hidden");
    document.getElementById("examScreen").classList.remove("hidden");
    document.getElementById("webcam-container").classList.remove("hidden");
    document.getElementById("timer").classList.remove("hidden");
    
    // Initialize questions
    questions = sampleQuestions;
    renderQuestions();
    updateProgress();
    
    // Start camera
    startCamera();
    
    // Start timer
    startTimer();
    
    // Start noise monitoring
    startNoiseMonitoring();
    
    // Start tab change monitoring
    startTabMonitoring();
  }

  // Render all questions
  function renderQuestions() {
    const container = document.getElementById("questions-container");
    container.innerHTML = "";
    
    questions.forEach((question, index) => {
      const questionDiv = document.createElement("div");
      questionDiv.className = `question-container ${index === 0 ? "" : "hidden"}`;
      questionDiv.id = `question-${index}`;
      
      let optionsHTML = "";
      question.options.forEach(option => {
        optionsHTML += `
          <label>
            <input type="radio" name="${question.id}" value="${option.value}">
            ${option.value}) ${option.text}
          </label>
        `;
      });
      
      questionDiv.innerHTML = `
        <div class="question">
          <h3>${question.text}</h3>
          <div class="options">${optionsHTML}</div>
        </div>
      `;
      
      container.appendChild(questionDiv);
    });
  }

  // Navigate between questions
  function navigateQuestion(direction) {
    // Hide current question
    document.getElementById(`question-${currentQuestionIndex}`).classList.add("hidden");
    
    // Update index
    currentQuestionIndex += direction;
    
    // Show new question
    document.getElementById(`question-${currentQuestionIndex}`).classList.remove("hidden");
    
    // Update navigation buttons
    updateNavigationButtons();
    updateProgress();
  }

  // Update navigation buttons state
  function updateNavigationButtons() {
    document.getElementById("prevBtn").disabled = currentQuestionIndex === 0;
    document.getElementById("nextBtn").disabled = currentQuestionIndex === questions.length - 1;
    
    // Change next button to submit on last question
    if (currentQuestionIndex === questions.length - 1) {
      document.getElementById("nextBtn").style.display = 'none';
      document.getElementById("submitBtn").style.display = 'block';
    } else {
      document.getElementById("nextBtn").style.display = 'block';
      document.getElementById("submitBtn").style.display = 'none';
    }
  }

  // Update progress counters
  function updateProgress() {
    // Update question count
    document.getElementById("progress-count").textContent = 
      `Question ${currentQuestionIndex + 1} of ${questions.length}`;
    
    // Update answered count
    const answered = document.querySelectorAll('input[type="radio"]:checked').length;
    document.getElementById("answered-count").textContent = 
      `Answered: ${answered}/${questions.length}`;
  }

  // Start camera
  function startCamera() {
    navigator.mediaDevices.getUserMedia({ 
      video: { 
        width: { ideal: 320 }, 
        height: { ideal: 240 },
        facingMode: "user" 
      },
      audio: false
    })
    .then(stream => {
      document.getElementById("webcam").srcObject = stream;
      
      // Monitor camera for visibility changes
      const videoTrack = stream.getVideoTracks()[0];
      const settings = videoTrack.getSettings();
      
      // Check periodically if camera is still active
      setInterval(() => {
        if (videoTrack.readyState === 'ended') {
          showWarning("Camera disconnected! Please reconnect your camera.");
        }
      }, 5000);
    })
    .catch(error => {
      console.error("Camera access error:", error);
      alert("Camera access is required for exam monitoring!");
    });
  }

  // Start timer
  function startTimer() {
    let timeLeft = 7200; // 2 hours in seconds
    const timerElement = document.getElementById("timer");
    
    timerInterval = setInterval(() => {
      const hrs = Math.floor(timeLeft / 3600);
      const mins = Math.floor((timeLeft % 3600) / 60);
      const secs = timeLeft % 60;
      
      timerElement.textContent = `Time Left: ${hrs}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      
      if (--timeLeft <= 0) {
        clearInterval(timerInterval);
        document.getElementById("examForm").requestSubmit();
        alert("Time's up! Your exam has been automatically submitted.");
      }
    }, 1000);
  }

  // Start noise monitoring
  function startNoiseMonitoring() {
    try {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      let analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      
      navigator.mediaDevices.getUserMedia({ audio: true, video: false })
        .then(stream => {
          let microphone = audioContext.createMediaStreamSource(stream);
          microphone.connect(analyser);
          
          let bufferLength = analyser.frequencyBinCount;
          let dataArray = new Uint8Array(bufferLength);
          let noiseThreshold = 50; // Adjust this based on testing
          let quietFrames = 0;
          
          noiseMonitorInterval = setInterval(() => {
            analyser.getByteFrequencyData(dataArray);
            let total = 0;
            
            for (let i = 0; i < bufferLength; i++) {
              total += dataArray[i];
            }
            
            let average = total / bufferLength;
            
            if (average > noiseThreshold) {
              quietFrames = 0;
              warningCount++;
              
              if (warningCount > 3) {
                showWarning("noise");
              }
            } else {
              quietFrames++;
              if (quietFrames > 10) {
                warningCount = Math.max(0, warningCount - 1);
              }
            }
          }, 200);
        })
        .catch(err => {
          console.log("Audio monitoring not available:", err);
        });
    } catch (e) {
      console.log("AudioContext not supported:", e);
    }
  }

  // Start tab monitoring
  function startTabMonitoring() {
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) {
        showWarning("tab");
      }
    });
    
    window.addEventListener("blur", () => {
      showWarning("tab");
    });
  }

  // Show warning message
  function showWarning(type) {
    if (type === "noise") {
      document.getElementById("noise-warning").style.display = 'block';
    } else if (type === "tab") {
      document.getElementById("tab-warning").style.display = 'block';
    }
    
    // Log warning to Firebase
    db.collection("exam_warnings").add({
      type: type,
      timestamp: new Date(),
      studentName: document.getElementById("studentName").value,
      studentPhone: document.getElementById("studentPhone").value
    });
  }

  // Form submission
  document.getElementById("examForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    
    // Disable submit button to prevent multiple submissions
    const submitBtn = this.querySelector("button[type='submit']");
    submitBtn.disabled = true;
    submitBtn.textContent = "Submitting...";
    
    try {
      // Get student info
      const name = document.getElementById("studentName").value;
      const phone = document.getElementById("studentPhone").value;
      const level = document.getElementById("studentClass").value;
      
      // Collect all answers
      const answers = {};
      const radioButtons = document.querySelectorAll('input[type="radio"]:checked');
      radioButtons.forEach(radio => {
        answers[radio.name] = radio.value;
      });
      
      // Calculate score
      let score = 0;
      Object.keys(answers).forEach(q => {
        if(correctAnswers[q] && answers[q] === correctAnswers[q]) {
          score++;
        }
      });
      
      // Total number of questions
      const totalQuestions = questions.length;
      const percentage = (score/totalQuestions * 100).toFixed(2);
      
      // Save to Firebase
      await db.collection("exam_results").add({
        name: name,
        phone: phone,
        level: level,
        score: score,
        total: totalQuestions,
        percentage: percentage,
        time: new Date().toLocaleString(),
        answers: answers
      });
      
      // Store result for PDF generation
      examResult = {
        name: name,
        level: level,
        score: score,
        total: totalQuestions,
        percentage: percentage,
        date: new Date().toLocaleString()
      };
      
      // Show result
      document.getElementById("resultBox").classList.remove("hidden");
      document.getElementById("resultBox").innerHTML = `
        <h3>Exam Submitted Successfully</h3>
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Class:</strong> ${level}</p>
        <p><strong>Score:</strong> ${score} / ${totalQuestions}</p>
        <p><strong>Percentage:</strong> ${percentage}%</p>
        <p><strong>Submitted:</strong> ${new Date().toLocaleString()}</p>
      `;
      
      // Show PDF download button
      document.getElementById("pdf-download").classList.remove("hidden");
      
      // Clean up
      clearInterval(timerInterval);
      clearInterval(noiseMonitorInterval);
      if (audioContext) {
        audioContext.close();
      }
      
    } catch (error) {
      console.error("Error submitting exam: ", error);
      alert("There was an error submitting your exam. Please try again.");
      submitBtn.disabled = false;
      submitBtn.textContent = "Submit Exam";
    }
  });

  // Generate PDF with logo and results
  function generatePDF() {
    const doc = new jsPDF();
    
    // Add logo (replace with your actual logo)
    const logoUrl = 'SCHOOL.jpg';
    
    // Add content to PDF
    doc.setFontSize(20);
    doc.setTextColor(40);
    doc.text('Daughters of Divine Love Juniorate', 105, 20, { align: 'center' });
    doc.setFontSize(16);
    doc.text('Entrance Examination Result', 105, 30, { align: 'center' });
    
    // Add student info
    doc.setFontSize(12);
    doc.text(`Name: ${examResult.name}`, 20, 50);
    doc.text(`Class: ${examResult.level}`, 20, 60);
    doc.text(`Date: ${examResult.date}`, 20, 70);
    
    // Add score summary
    doc.setFontSize(14);
    doc.setTextColor(0, 100, 0);
    doc.text('Exam Results Summary', 20, 90);
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text(`Score: ${examResult.score} out of ${examResult.total}`, 20, 100);
    doc.text(`Percentage: ${examResult.percentage}%`, 20, 110);
    
    // Add grading
    doc.setFontSize(14);
    doc.setTextColor(0, 100, 0);
    doc.text('Grading', 20, 130);
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text('A: 80% - 100%', 20, 140);
    doc.text('B: 70% - 79%', 20, 150);
    doc.text('C: 60% - 69%', 20, 160);
    doc.text('D: 50% - 59%', 20, 170);
    doc.text('F: Below 50%', 20, 180);
    
    // Add footer
    doc.setFontSize(10);
    doc.setTextColor(100);
    doc.text('© 2023 Daughters of Divine Love Juniorate. All rights reserved.', 105, 280, { align: 'center' });
    
    // Save the PDF
    doc.save(`DDL_Exam_Result_${examResult.name.replace(' ', '_')}.pdf`);
  }

  // Update progress when answers change
  document.addEventListener('change', function(e) {
    if (e.target && e.target.matches('input[type="radio"]')) {
      updateProgress();
    }
  });
</script>
</body>
</html>