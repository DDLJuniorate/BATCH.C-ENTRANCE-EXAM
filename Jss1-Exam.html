<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daughters of Divine Love Abakpa, Enugu.<br>2025/2026 Academic Session Batch C Entrance Examination</title>
  <style>
    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: #100669; 
      background-image: url(admissionposter.jpg);

      margin: 0; 
      padding: 0; 
      
    }
    .container { 
      max-width: 800px; 
      margin: auto; 
      background: #190466; 
      padding: 20px; 
      border-radius: 10px; 
      margin-top: 30px; 
      box-shadow: 0 0 10px rgba(148, 65, 65, 0.1);
      position: relative;

    }
    header { 
      text-align: center; 
      background: #3f51b5; 
      color: white; 
      padding: 20px; 
    }
    header h1 { 
      margin: 5px 0; 
      font-size: 20px; 
    }
    .question-container {
      margin-bottom: 20px;
      position: relative;
    }
    .question { 
      margin-bottom: 20px; 
    }
    .options label { 
      display: block; 
      margin-bottom: 5px; 
      padding: 8px;
      border-radius: 4px;
    }
    .options label:hover {
      background-color: #f0f0f0;
    }
    #timer { 
      font-weight: bold; 
      color: red; 
      text-align: right; 
      position: fixed;
      top: 10px;
      right: 10px;
      background: white;
      padding: 5px 10px;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    #webcam-container {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 150px;
      height: 100px;
      z-index: 1000;
      border: 2px solid #3f51b5;
      border-radius: 5px;
      overflow: hidden;
    }
    #webcam {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .hidden { 
      display: none; 
    }
    button { 
      padding: 10px 20px; 
      background: #3f51b5; 
      color: white; 
      border: none; 
      border-radius: 5px; 
      cursor: pointer; 
      margin-top: 15px; 
      font-size: 16px;
    }
    button:disabled { 
      background: gray; 
    }
    .result { 
      background: #e3f2fd; 
      padding: 20px; 
      margin-top: 20px; 
      border-left: 4px solid #2196f3; 
    }
    input[type="text"], select { 
      width: 100%; 
      padding: 10px; 
      margin: 10px 0; 
      font-size: 16px;
    }
    .progress-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      font-size: 14px;
      color: #555;
    }
    .question-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    .warning-alert {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ff4444;
      color: white;
      padding: 20px;
      border-radius: 5px;
      z-index: 2000;
      display: none;
      text-align: center;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    #noise-warning {
      background-color: #ff8800;
    }
    #tab-warning {
      background-color: #ff4444;
    }
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 15px;
      }
      #webcam-container {
        width: 100px;
        height: 80px;
      }
      #timer {
        font-size: 14px;
      }
      button {
        padding: 8px 16px;
        width: 100%;
        margin: 5px 0;
      }
      .question-nav {
        flex-direction: column;
      }
      .logo {
  width: 100%;
  max-width: 150px;
  height: auto;
  align-items: center;
}
    }
  </style>
</head>
<body>

<header>
    <img src="SCHOOL.jpg" alt="Logo" width="100", style="float:left;">
  <h1 style="font-size: 250%; color: #9ae709;">DAUGHTERS OF DIVINE LOVE JUNIORATE ABAKPA, ENUGU</h1>
  <p style="font-size: 150%;"><b>2025/2026 Academic Session Batch C Entrance Examination</p>
</header>

<div id="webcam-container" class="hidden">
  <video id="webcam" autoplay playsinline></video>
</div>

<div id="timer" class="hidden">Time Left: 1:00:00</div>

<div class="container" id="startScreen">
  <h3 style="color: #e8e7eb; text-align: center;">Student Information</h3>
  <p style="color: #f8f8fa;text-align: center;"><b>Make sure you have read the information carefully before starting the exam</p>
  <input type="text" id="studentName" placeholder="Full Name" required />
  <input type="text" id="studentClass" placeholder="Class Applying Into" required />
  <input type="text" id="studentPhone" placeholder="Phone Number" required />
  <button onclick="startExam()">Start Exam</button>
</div>

<div class="container hidden" id="examScreen">
  <div class="progress-container">
    <div id="progress-count">Question 1 of 70</div>
    <div id="answered-count">Answered: 0/70</div>
  </div>
  <form id="examForm", style="color: #d8e709;">
    <div id="questions-container">
      <!-- Questions will be dynamically inserted here -->
    </div>

    <div class="question-nav">
      <button type="button" id="prevBtn" onclick="navigateQuestion(-1)" disabled>Previous</button>
      <button type="button" id="nextBtn" onclick="navigateQuestion(1)">Next</button>
    </div>

    <button type="submit" id="submitBtn">Submit Exam</button>
  </form>

  <div class="result hidden" id="resultBox"></div>
  <button id="pdf-download" class="hidden" onclick="generatePDF()">Download Result as PDF</button>
</div>

<div class="warning-alert" id="noise-warning">
  <h3>Warning!</h3>
  <p>Excessive noise detected. Please maintain silence during the exam.</p>
  <button onclick="document.getElementById('noise-warning').style.display = 'none'">OK</button>
</div>

<div class="warning-alert" id="tab-warning">
  <h3>Warning!</h3>
  <p>Do not switch tabs or leave this page during the exam!</p>
  <button onclick="document.getElementById('tab-warning').style.display = 'none'">OK</button>
</div>

<!-- Libraries -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAG2INXGOyaxW6cewhM-uiYTvydkGvQRgc",
    authDomain: "ddl-exam-report.firebaseapp.com",
    projectId: "ddl-exam-report",
    storageBucket: "ddl-exam-report.appspot.com",
    messagingSenderId: "1060940461659",
    appId: "1:1060940461659:web:3afc9539da4cd81c3df17e",
    measurementId: "G-3BHGRDYCMH"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const { jsPDF } = window.jspdf;

  // Global variables
  let currentQuestionIndex = 0;
  let questions = [];
  let examResult = {};
  let timerInterval;
  let audioContext;
  let noiseMonitorInterval;
  let warningCount = 0;

  // Sample questions - replace with your actual questions
  
  const sampleQuestions = [
    // English Questions

    
    {
    id: "q_eng_1",
    subject: "English",
    text: "1. According to the passage Dane _______________",
    options: [
      { value: "A", text: "was a rude boy" },
      { value: "B", text: "Respected everybody" },
      { value: "C", text: "Was a crook" },
      { value: "D", text: "Was only rude to his mates" }
    ]
  },
  {
    id: "q_eng_2",
    subject: "English",
    text: "2. Which of the following contributed to Dane’s bad behaviour?",
    options: [
      { value: "A", text: "His parents advised him to be a good boy" },
      { value: "B", text: "His parents were not at home" },
      { value: "C", text: "He hated everyone" },
      { value: "D", text: "His parents encouraged him" }
    ]
  },
  {
    id: "q_eng_3",
    subject: "English",
    text: "3. What did the other children’s parents do?",
    options: [
      { value: "A", text: "They tolerate Dane’s rudeness" },
      { value: "B", text: "They avoided Dane" },
      { value: "C", text: "They did not say anything" },
      { value: "D", text: "They told their children to keep away from Dane" }
    ]
  },
  {
    id: "q_eng_4",
    subject: "English",
    text: "4. What was Dane’s first reaction when nobody played with him?",
    options: [
      { value: "A", text: "He was happy" },
      { value: "B", text: "He did not mind" },
      { value: "C", text: "He pretended he did not feel it" },
      { value: "D", text: "He felt hopeless" }
    ]
  },
  {
    id: "q_eng_5",
    subject: "English",
    text: "5. The teacher would not allow us to stay in school unless we paid our fees.",
    options: [
      { value: "A", text: "Admit" },
      { value: "B", text: "Favour" },
      { value: "C", text: "Leave" },
      { value: "D", text: "Permit" }
    ]
  },
  {
    id: "q_eng_6",
    subject: "English",
    text: "6. Sugar soon melts in hot ovaltine.",
    options: [
      { value: "A", text: "Collapse" },
      { value: "B", text: "Decompose" },
      { value: "C", text: "Dissolves" },
      { value: "D", text: "Evaporates" }
    ]
  },
  {
    id: "q_eng_7",
    subject: "English",
    text: "7. The farmers could no longer stand the heat of the sun.",
    options: [
      { value: "A", text: "Bear" },
      { value: "B", text: "Accept" },
      { value: "C", text: "Enjoy" },
      { value: "D", text: "Wait in" }
    ]
  },
    {
    id: "q_eng_8",
    subject: "English",
    text: "8. The screw is fixed very loosely in the lid.",
    options: [
      { value: "A", text: "Closely" },
      { value: "B", text: "Squarely" },
      { value: "C", text: "Tightly" },
      { value: "D", text: "Well" }
    ]
  },
  {
    id: "q_eng_9",
    subject: "English",
    text: "9. We remember our school days because they were so full of joys.",
    options: [
      { value: "A", text: "Difficulties" },
      { value: "B", text: "Sorrows" },
      { value: "C", text: "Troubles" },
      { value: "D", text: "Worries" }
    ]
  },
  {
    id: "q_eng_10",
    subject: "English",
    text: "10. The man was discharged and acquitted, because he was found innocent.",
    options: [
      { value: "A", text: "Blameless" },
      { value: "B", text: "Guilty" },
      { value: "C", text: "Free" },
      { value: "D", text: "Harmless" }
    ]
  },
  {
    id: "q_eng_11",
    subject: "English",
    text: "11. We said to the girl 'Will you come at once?' can be re-written as: We asked the girl ____ at once.",
    options: [
      { value: "A", text: "If she can come" },
      { value: "B", text: "If she should come" },
      { value: "C", text: "If she would come" },
      { value: "D", text: "That she should come" }
    ]
  },
  {
    id: "q_eng_12",
    subject: "English",
    text: "12. Dora said 'I shall see her tomorrow' can be re-written as:",
    options: [
      { value: "A", text: "She would see her the next day" },
      { value: "B", text: "I should see you tomorrow" },
      { value: "C", text: "That she should see her the next day" },
      { value: "D", text: "She wanted to see her" }
    ]
  },
  {
    id: "q_eng_13",
    subject: "English",
    text: "13. The tree I _____ is growing well.",
    options: [
      { value: "A", text: "has plant" },
      { value: "B", text: "have plant" },
      { value: "C", text: "plant" },
      { value: "D", text: "planted" }
    ]
  },
  {
    id: "q_eng_14",
    subject: "English",
    text: "14. Choose the correctly spelt word.",
    options: [
      { value: "A", text: "Necessary" },
      { value: "B", text: "Necesary" },
      { value: "C", text: "Neceesary" },
      { value: "D", text: "Necesory" }
    ]
  },
  {
    id: "q_eng_15",
    subject: "English",
    text: "15. Choose the correctly spelt word.",
    options: [
      { value: "A", text: "Solijar" },
      { value: "B", text: "Solider" },
      { value: "C", text: "Soldier" },
      { value: "D", text: "Soldiar" }
    ]
  },
  {
    id: "q_eng_16",
    subject: "English",
    text: "16. Choose the correctly spelt word.",
    options: [
      { value: "A", text: "Restorant" },
      { value: "B", text: "restaurant" },
      { value: "C", text: "restorant" },
      { value: "D", text: "Restanurent" }
    ]
  },
  {
    id: "q_eng_17",
    subject: "English",
    text: "17. Choose the correctly spelt word.",
    options: [
      { value: "A", text: "Ocasion" },
      { value: "B", text: "Occasion" },
      { value: "C", text: "Ocassion" },
      { value: "D", text: "Occassion" }
    ]
  },
  {
    id: "q_eng_18",
    subject: "English",
    text: "18. Choose the correctly spelt word.",
    options: [
      { value: "A", text: "Permisible" },
      { value: "B", text: "Permissible" },
      { value: "C", text: "Permissable" },
      { value: "D", text: "Parmisible" }
    ]
  },
  {
  id: "q_eng_19",
  subject: "English",
  type: "part_of_speech",
  text: "19. The latecomers were asked to run round the parade ground.",
  question: "Identify the part of speech of the underlined word: 'run'",
  options: [
    { value: "A", text: "Noun" },
    { value: "B", text: "Verb" },
    { value: "C", text: "Adverb" },
    { value: "D", text: "Pronoun" }
  ],
},
{
  id: "q_eng_20",
  subject: "English",
  type: "part_of_speech",
  text: "20. He spoke too loudly when he was asked a question.",
  question: "Identify the part of speech of the underlined word: 'loudly'",
  options: [
    { value: "A", text: "Noun" },
    { value: "B", text: "Verb" },
    { value: "C", text: "Adverb" },
    { value: "D", text: "Pronoun" }
  ]
},
{
  id: "q_eng_21",
  subject: "English",
  type: "part_of_speech",
  text: "21. Abuja is one of the cities in Nigeria.",
  question: "Identify the part of speech of the underlined word: 'Abuja'",
  options: [
    { value: "A", text: "Noun" },
    { value: "B", text: "Verb" },
    { value: "C", text: "Adverb" },
    { value: "D", text: "Pronoun" }
  ]
},

{
  id: "q_eng_22",
  subject: "English",
  type: "vowel_sound",
  text: "22. Choose the word that has the same vowel sound as the underlined letters in 'Shield'.",
  options: [
    { value: "A", text: "Tried" },
    { value: "B", text: "Dream" },
    { value: "C", text: "Bed" },
    { value: "D", text: "Thick" }
  ],
  answer: "B"
},
{
  id: "q_eng_23",
  subject: "English",
  type: "vowel_sound",
  text: "23. Choose the word that has the same vowel sound as the underlined letters in 'Sieve'.",
  options: [
    { value: "A", text: "Police" },
    { value: "B", text: "Brief" },
    { value: "C", text: "Perceive" },
    { value: "D", text: "Milk" }
  ]
},
{
  id: "q_eng_24",
  subject: "English",
  type: "consonant_sound",
  text: "24. Choose the word that has the same consonant sound as the underlined letters in 'Jumped'.",
  options: [
    { value: "A", text: "Boy" },
    { value: "B", text: "Tame" },
    { value: "C", text: "Queen" },
    { value: "D", text: "Dance" }
  ]
},

{
  id: "q_eng_25",
  subject: "English",
  type: "consonant_sound",
  text: "24. Choose the word that has the same consonant sound as the underlined letters in 'Thomas'.",
  options: [
    { value: "A", text: "Last" },
    { value: "B", text: "Bird" },
    { value: "C", text: "Slam" },
    { value: "D", text: "Slim" }
  ]
},
    // Add more questions here...
    // Math Questions
    
  {
    id: "q_math_1",
    subject: "Mathematics",
    text: "1. How many lines of symmetry has a parallelogram?",
    options: [
      { value: "A", text: "One" },
      { value: "B", text: "Two" },
      { value: "C", text: "None" },
      { value: "D", text: "Four" },
      { value: "E", text: "Eight" }
    ]
  },
  {
    id: "q_math_2",
    subject: "Mathematics",
    text: "2. Change 3/5 to percentage",
    options: [
      { value: "A", text: "30%" },
      { value: "B", text: "70%" },
      { value: "C", text: "60%" },
      { value: "D", text: "65%" },
      { value: "E", text: "40%" }
    ]
  },
  {
    id: "q_math_3",
    subject: "Mathematics",
    text: "3. N1400 is to be shared among three boys in the ratio of 4:2:1, what is the lion share?",
    options: [
      { value: "A", text: "N400" },
      { value: "B", text: "N800" },
      { value: "C", text: "N200" },
      { value: "D", text: "N100" },
      { value: "E", text: "N140" }
    ]
  },
  {
    id: "q_math_4",
    subject: "Mathematics",
    text: "4. An angle more than 90º but less than 180º is called",
    options: [
      { value: "A", text: "Acute angle" },
      { value: "B", text: "Obtuse angle" },
      { value: "C", text: "Zero angle" },
      { value: "D", text: "Right angle" },
      { value: "E", text: "Round angle" }
    ]
  },
  {
    id: "q_math_5",
    subject: "Mathematics",
    text: "5. Write in words 3,675.",
    options: [
      { value: "A", text: "Three thousand and sixty seven five" },
      { value: "B", text: "Three thousand six hundred and seventy five" },
      { value: "C", text: "Thirty six hundred and seventy five" },
      { value: "D", text: "Thirty six and seventy five" },
      { value: "E", text: "Thirty six thousand and seventy five" }
    ]
  },
  {
    id: "q_math_6",
    subject: "Mathematics",
    text: "6. Approximate 4.1984 to the nearest hundredth",
    options: [
      { value: "A", text: "4.198" },
      { value: "B", text: "0.049" },
      { value: "C", text: "0.49" },
      { value: "D", text: "4.20" },
      { value: "E", text: "4.19" }
    ]
  },
  {
    id: "q_math_7",
    subject: "Mathematics",
    text: "19. Express 600 in Roman numerals.",
    options: [
      { value: "A", text: "CCLVIII" },
      { value: "B", text: "DC" },
      { value: "C", text: "XXXVIII" },
      { value: "D", text: "CCXXXVIII" },
      { value: "E", text: "CXL" }
    ]
  },
  {
    id: "q_math_8",
    subject: "Mathematics",
    text: "8. What is the simple interest on N300 for 4 years at 20%?",
    options: [
      { value: "A", text: "240" },
      { value: "B", text: "1500" },
      { value: "C", text: "150" },
      { value: "D", text: "2400" },
      { value: "E", text: "500" }
    ]
  },
  {
    id: "q_math_9",
    subject: "Mathematics",
    text: "9. What is the place value of 7 in 4759?",
    options: [
      { value: "A", text: "7" },
      { value: "B", text: "700" },
      { value: "C", text: "70" },
      { value: "D", text: "7000" },
      { value: "E", text: "0.7" }
    ]
  },
  {
    id: "q_math_10",
    subject: "Mathematics",
    text: "10. Add up: 2 dozen, 1 score and 1 gross.",
    options: [
      { value: "A", text: "26" },
      { value: "B", text: "188" },
      { value: "C", text: "780" },
      { value: "D", text: "95" },
      { value: "E", text: "100" }
    ]
  },
  {
    id: "q_math_11",
    subject: "Mathematics",
    text: "11. Uche had 51 oranges while Okeke had 35. How many oranges will Uche give to Okeke so that they have equal oranges?",
    options: [
      { value: "A", text: "35" },
      { value: "B", text: "8" },
      { value: "C", text: "7" },
      { value: "D", text: "5" },
      { value: "E", text: "12" }
    ]
  },
  {
    id: "q_math_12",
    subject: "Mathematics",
    text: "12. The sum of two right angles is equal to",
    options: [
      { value: "A", text: "90º" },
      { value: "B", text: "150º" },
      { value: "C", text: "100º" },
      { value: "D", text: "180º" },
      { value: "E", text: "360º" }
    ]
  },
  {
    id: "q_math_13",
    subject: "Mathematics",
    text: "13. Find the area of a parallelogram with base 12m and height 18m.",
    options: [
      { value: "A", text: "72m" },
      { value: "B", text: "48m" },
      { value: "C", text: "144m" },
      { value: "D", text: "108m" },
      { value: "E", text: "216m" }
    ]
  },
  {
    id: "q_math_14",
    subject: "Mathematics",
    text: "14. An Octagon is a polygon with how many sides?",
    options: [
      { value: "A", text: "7" },
      { value: "B", text: "3" },
      { value: "C", text: "5" },
      { value: "D", text: "8" },
      { value: "E", text: "5" }
    ]
  },
  {
    id: "q_math_15",
    subject: "Mathematics",
    text: "15. A student is counted 13th from the right and 8th from the left. How many students are there in total?",
    options: [
      { value: "A", text: "18" },
      { value: "B", text: "19" },
      { value: "C", text: "20" },
      { value: "D", text: "21" },
      { value: "E", text: "22" }
    ]
  },
  {
    id: "q_math_16",
    subject: "Mathematics",
    text: "16. A pentagon is a polygon with how many sides?",
    options: [
      { value: "A", text: "8" },
      { value: "B", text: "5" },
      { value: "C", text: "3" },
      { value: "D", text: "4" },
      { value: "E", text: "7" }
    ]
  },
  {
    id: "q_math_17",
    subject: "Mathematics",
    text: "17. 4(3x+2) = 152, solve for x.",
    options: [
      { value: "A", text: "10" },
      { value: "B", text: "9" },
      { value: "C", text: "12" },
      { value: "D", text: "38" },
      { value: "E", text: "11" }
    ]
  },
  {
    id: "q_math_18",
    subject: "Mathematics",
    text: "18. Find the area of a circle whose perimeter is 44cm (Take ˄ = 22/7)",
    options: [
      { value: "A", text: "154cm²" },
      { value: "B", text: "14cm²" },
      { value: "C", text: "49cm²" },
      { value: "D", text: "22cm²" },
      { value: "E", text: "44cm²" }
    ]
  },
  {
    id: "q_math_19",
    subject: "Mathematics",
    text: "19. Express 238 in Roman numerals.",
    options: [
      { value: "A", text: "CCLVIII" },
      { value: "B", text: "DDVIII" },
      { value: "C", text: "XXXVIII" },
      { value: "D", text: "CCXXXVIII" },
      { value: "E", text: "CXL" }
    ]
  },

  {
    id: "q_math_20",
    subject: "Mathematics",
    text: "19. Express 300 in Roman numerals.",
    options: [
      { value: "A", text: "CCC" },
      { value: "B", text: "DDVIII" },
      { value: "C", text: "XXXVIII" },
      { value: "D", text: "CCXXXVIII" },
      { value: "E", text: "CXL" }
    ]
  },


    // General Paper Questions
     {
    id: "q_gp_1",
    subject: "General Paper",
    text: "1. The Father of all Nations is _________",
    options: [
      { value: "A", text: "John the Baptist" },
      { value: "B", text: "David" },
      { value: "C", text: "Abraham" },
      { value: "D", text: "Saul" }
    ]
  },
  {
    id: "q_gp_2",
    subject: "General Paper",
    text: "2. The person that helped Jesus to carry His cross is",
    options: [
      { value: "A", text: "Judas Iscariot" },
      { value: "B", text: "John" },
      { value: "C", text: "Joseph of Armathea" },
      { value: "D", text: "Simon of Cyrene" }
    ]
  },
  {
    id: "q_gp_3",
    subject: "General Paper",
    text: "3. Original sin is the sin of ____",
    options: [
      { value: "A", text: "PortiPhar and his wife" },
      { value: "B", text: "Adam and Eve" },
      { value: "C", text: "Ahab and Jezbel" },
      { value: "D", text: "Judas Iscariot" }
    ]
  },
  {
    id: "q_gp_4",
    subject: "General Paper",
    text: "4. The world during the time of Noah was destroyed by",
    options: [
      { value: "A", text: "Fire" },
      { value: "B", text: "Flood" },
      { value: "C", text: "Thunder" },
      { value: "D", text: "Bomb" }
    ]
  },
  {
    id: "q_gp_5",
    subject: "General Paper",
    text: "5. Moses ran away from Egypt because ____",
    options: [
      { value: "A", text: "He did not pay tax" },
      { value: "B", text: "He killed an Egyptian" },
      { value: "C", text: "He ate his masters food" },
      { value: "D", text: "He wanted to be a Monk" }
    ]
  },
  {
    id: "q_gp_6",
    subject: "General Paper",
    text: "6. The king who wanted to kill Jesus Christ when he was born was ___",
    options: [
      { value: "A", text: "Herod" },
      { value: "B", text: "Pilate" },
      { value: "C", text: "Caiaphas" },
      { value: "D", text: "Solomon" }
    ]
  },
  {
    id: "q_gp_7",
    subject: "General Paper",
    text: "7. The Holy spirit descended on the apostles on the ____day",
    options: [
      { value: "A", text: "Easter" },
      { value: "B", text: "Ascension" },
      { value: "C", text: "Caiaphas" },
      { value: "D", text: "Solomon" }
    ]
  },
  {
    id: "q_gp_8",
    subject: "General Paper",
    text: "8. The three Jewish men that were thrown into fire by Nebuchadnezzar were Shedrack, Mischack and",
    options: [
      { value: "A", text: "Abel" },
      { value: "B", text: "Abadnego" },
      { value: "C", text: "Joseph" },
      { value: "D", text: "Daniel" }
    ]
  },
  {
    id: "q_gp_9",
    subject: "General Paper",
    text: "9. There were ________ apostles selected by Jesus Christ",
    options: [
      { value: "A", text: "70" },
      { value: "B", text: "12" },
      { value: "C", text: "4" },
      { value: "D", text: "14" }
    ]
  },
  {
    id: "q_gp_10",
    subject: "General Paper",
    text: "10. The mother of John the Baptist is ____",
    options: [
      { value: "A", text: "Mary" },
      { value: "B", text: "Naomi" },
      { value: "C", text: "Elizabeth" },
      { value: "D", text: "Esther" }
    ]
  },
  {
    id: "q_gp_11",
    subject: "General Paper",
    text: "11. The person who interpreted Pharaoh's dreams was",
    options: [
      { value: "A", text: "Moses" },
      { value: "B", text: "Jacob" },
      { value: "C", text: "Joseph" },
      { value: "D", text: "Amos" }
    ]
  },
  {
    id: "q_gp_12",
    subject: "General Paper",
    text: "12. When Jesus was born _______ from the east came to worship",
    options: [
      { value: "A", text: "Shepherds" },
      { value: "B", text: "Wise men" },
      { value: "C", text: "Hunters" },
      { value: "D", text: "Angels" }
    ]
  },
  {
    id: "q_gp_13",
    subject: "General Paper",
    text: "13. The fruit God instructed Adam not to eat was from the tree in the _________",
    options: [
      { value: "A", text: "Middle of the garden" },
      { value: "B", text: "Front of the garden" },
      { value: "C", text: "Side of the garden" },
      { value: "D", text: "Other side of the garden" }
    ]
  },
  {
    id: "q_gp_14",
    subject: "General Paper",
    text: "14. David killed__________",
    options: [
      { value: "A", text: "Paul" },
      { value: "B", text: "Jonathan" },
      { value: "C", text: "Saul" },
      { value: "D", text: "Goliath" }
    ]
  },
  {
    id: "q_gp_15",
    subject: "General Paper",
    text: "15. Bad dressing at home and on the street can lead us into",
    options: [
      { value: "A", text: "Paradise" },
      { value: "B", text: "Grace" },
      { value: "C", text: "Temptation" },
      { value: "D", text: "Joy" }
    ]
  },
  {
    id: "q_gp_16",
    subject: "General Paper",
    text: "16. The smallest of the planets is ______",
    options: [
      { value: "A", text: "Venus" },
      { value: "B", text: "Mercury" },
      { value: "C", text: "Neptune" },
      { value: "D", text: "Jupiter" }
    ]
  },
  {
    id: "q_gp_17",
    subject: "General Paper",
    text: "17. The part of air that supports burning is called?",
    options: [
      { value: "A", text: "CO₂" },
      { value: "B", text: "Oxygen" },
      { value: "C", text: "Gas" },
      { value: "D", text: "Petroleum" }
    ]
  },
  {
    id: "q_gp_18",
    subject: "General Paper",
    text: "18. Photosynthesis is the process of",
    options: [
      { value: "A", text: "Building up of food by green plants" },
      { value: "B", text: "Decay of waste matter" },
      { value: "C", text: "Producing alcohol in palm wine" },
      { value: "D", text: "Purifying water with chlorine" }
    ]
  },
  {
    id: "q_gp_19",
    subject: "General Paper",
    text: "19. In the manufacture of cement, we make use of _______",
    options: [
      { value: "A", text: "Limestone" },
      { value: "B", text: "Stone" },
      { value: "C", text: "Gravel" },
      { value: "D", text: "Zinc" }
    ]
  },
  {
    id: "q_gp_20",
    subject: "General Paper",
    text: "20. Materials that allow electricity to pass through them are called",
    options: [
      { value: "A", text: "Insulators" },
      { value: "B", text: "Circuit" },
      { value: "C", text: "Fuses" },
      { value: "D", text: "Conductors" }
    ]
  },
  {
    id: "q_gp_21",
    subject: "General Paper",
    text: "21. Employment means____",
    options: [
      { value: "A", text: "Not having a job or work" },
      { value: "B", text: "Having work to celebrate" },
      { value: "C", text: "Having work to do and earning a living" },
      { value: "D", text: "Having work in abundance" }
    ]
  },
  {
    id: "q_gp_22",
    subject: "General Paper",
    text: "22. The socially and approved union between a man and a woman is called _____",
    options: [
      { value: "A", text: "Union" },
      { value: "B", text: "Friendship" },
      { value: "C", text: "Marriage" },
      { value: "D", text: "Church wedding" }
    ]
  },
  {
    id: "q_gp_23",
    subject: "General Paper",
    text: "23. The act of avoiding too much or too little of anything is known as___",
    options: [
      { value: "A", text: "Self control" },
      { value: "B", text: "Moderation" },
      { value: "C", text: "Emotion control" },
      { value: "D", text: "Humility" }
    ]
  },
  {
    id: "q_gp_24",
    subject: "General Paper",
    text: "24. Returning lost items to the police is an act of______",
    options: [
      { value: "A", text: "Corruption" },
      { value: "B", text: "Patriotism" },
      { value: "C", text: "Neighbourhood" },
      { value: "D", text: "Sacrifice" }
    ]
  },
  {
    id: "q_gp_25",
    subject: "General Paper",
    text: "25. The government institution responsible for the control of food and drugs is ____",
    options: [
      { value: "A", text: "NAFDAC" },
      { value: "B", text: "INEC" },
      { value: "C", text: "UBE" },
      { value: "D", text: "NAFAC" }
    ]
  }
  ];

  // Correct answers - replace with your actual correct answers
  const correctAnswers = {
  q_eng_1: "A",
  q_eng_2: "D",
  q_eng_3: "D",
  q_eng_4: "D",
  q_eng_5: "D",
  q_eng_6: "C",
  q_eng_7: "A",
  q_eng_8: "C",
  q_eng_9: "D",
  q_eng_10: "B",
  q_eng_11: "C",
  q_eng_12: "C",
  q_eng_13: "D",
  q_eng_14: "A",
  q_eng_15: "C",
  q_eng_16: "B",
  q_eng_17: "B",
  q_eng_18: "B",
  q_eng_19: "B",
  q_eng_20: "C",
  q_eng_21: "A",
  q_eng_22: "B",
  q_eng_23: "D",
  q_eng_24: "B",
  q_eng_25: "A",

  q_math_1: "B",
  q_math_2: "C",
  q_math_3: "B",
  q_math_4: "B",
  q_math_5: "B",
  q_math_6: "D",
  q_math_7: "B",
  q_math_8: "A",
  q_math_9: "B",
  q_math_10: "B",
  q_math_11: "B",
  q_math_12: "D",
  q_math_13: "E",
  q_math_14: "D",
  q_math_15: "C",
  q_math_16: "B",
  q_math_17: "C",
  q_math_18: "A",
  q_math_19: "D",
  q_math_20: "A",

    q_gp_1: "C",
q_gp_2: "D",
q_gp_3: "B",
q_gp_4: "B",
q_gp_5: "B",
q_gp_6: "A",
q_gp_7: "D",
q_gp_8: "B",
q_gp_9: "B",
q_gp_10: "C",
q_gp_11: "C",
q_gp_12: "B",
q_gp_13: "A",
q_gp_14: "D",
q_gp_15: "C",
q_gp_16: "B",
q_gp_17: "B",
q_gp_18: "A",
q_gp_19: "A",
q_gp_20: "D",
q_gp_21: "C",
q_gp_22: "C",
q_gp_23: "B",
q_gp_24: "B",
q_gp_25: "A"

  };

  // Start exam function
  function startExam() {
    const name = document.getElementById("studentName").value.trim();
    const phone = document.getElementById("studentPhone").value.trim();
    const level = document.getElementById("studentClass").value.trim();
    
    if (!name || !phone || !level) {
      return alert("Please fill all fields");
    }
    
    document.getElementById("startScreen").classList.add("hidden");
    document.getElementById("examScreen").classList.remove("hidden");
    document.getElementById("webcam-container").classList.remove("hidden");
    document.getElementById("timer").classList.remove("hidden");
    
    // Initialize questions
    questions = sampleQuestions;
    renderQuestions();
    updateProgress();
    
    // Start camera
    startCamera();
    
    // Start timer
    startTimer();
    
    // Start noise monitoring
    startNoiseMonitoring();
    
    // Start tab change monitoring
    startTabMonitoring();
  }

  // Render all questions
  function renderQuestions() {
    const container = document.getElementById("questions-container");
    container.innerHTML = "";
    
    questions.forEach((question, index) => {
      const questionDiv = document.createElement("div");
      questionDiv.className = `question-container ${index === 0 ? "" : "hidden"}`;
      questionDiv.id = `question-${index}`;
      
      let optionsHTML = "";
      question.options.forEach(option => {
        optionsHTML += `
          <label>
            <input type="radio" name="${question.id}" value="${option.value}">
            ${option.value}) ${option.text}
          </label>
        `;
      });
      
      questionDiv.innerHTML = `
        <div class="question">
          <h3>${question.text}</h3>
          <div class="options">${optionsHTML}</div>
        </div>
      `;
      
      container.appendChild(questionDiv);
    });
  }

  // Navigate between questions
  function navigateQuestion(direction) {
    // Hide current question
    document.getElementById(`question-${currentQuestionIndex}`).classList.add("hidden");
    
    // Update index
    currentQuestionIndex += direction;
    
    // Show new question
    document.getElementById(`question-${currentQuestionIndex}`).classList.remove("hidden");
    
    // Update navigation buttons
    updateNavigationButtons();
    updateProgress();
  }

  // Update navigation buttons state
  function updateNavigationButtons() {
    document.getElementById("prevBtn").disabled = currentQuestionIndex === 0;
    document.getElementById("nextBtn").disabled = currentQuestionIndex === questions.length - 1;
    
    // Change next button to submit on last question
    if (currentQuestionIndex === questions.length - 1) {
      document.getElementById("nextBtn").style.display = 'none';
      document.getElementById("submitBtn").style.display = 'block';
    } else {
      document.getElementById("nextBtn").style.display = 'block';
      document.getElementById("submitBtn").style.display = 'none';
    }
  }

  // Update progress counters
  function updateProgress() {
    // Update question count
    document.getElementById("progress-count").textContent = 
      `Question ${currentQuestionIndex + 1} of ${questions.length}`;
    
    // Update answered count
    const answered = document.querySelectorAll('input[type="radio"]:checked').length;
    document.getElementById("answered-count").textContent = 
      `Answered: ${answered}/${questions.length}`;
  }

  // Start camera
  function startCamera() {
    navigator.mediaDevices.getUserMedia({ 
      video: { 
        width: { ideal: 320 }, 
        height: { ideal: 240 },
        facingMode: "user" 
      },
      audio: false
    })
    .then(stream => {
      document.getElementById("webcam").srcObject = stream;
      
      // Monitor camera for visibility changes
      const videoTrack = stream.getVideoTracks()[0];
      const settings = videoTrack.getSettings();
      
      // Check periodically if camera is still active
      setInterval(() => {
        if (videoTrack.readyState === 'ended') {
          showWarning("Camera disconnected! Please reconnect your camera.");
        }
      }, 5000);
    })
    .catch(error => {
      console.error("Camera access error:", error);
      alert("Camera access is required for exam monitoring!");
    });
  }

  // Start timer
  function startTimer() {
    let timeLeft = 7200; // 2 hours in seconds
    const timerElement = document.getElementById("timer");
    
    timerInterval = setInterval(() => {
      const hrs = Math.floor(timeLeft / 3600);
      const mins = Math.floor((timeLeft % 3600) / 60);
      const secs = timeLeft % 60;
      
      timerElement.textContent = `Time Left: ${hrs}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      
      if (--timeLeft <= 0) {
        clearInterval(timerInterval);
        document.getElementById("examForm").requestSubmit();
        alert("Time's up! Your exam has been automatically submitted.");
      }
    }, 1000);
  }

  // Start noise monitoring
  function startNoiseMonitoring() {
    try {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      let analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      
      navigator.mediaDevices.getUserMedia({ audio: true, video: false })
        .then(stream => {
          let microphone = audioContext.createMediaStreamSource(stream);
          microphone.connect(analyser);
          
          let bufferLength = analyser.frequencyBinCount;
          let dataArray = new Uint8Array(bufferLength);
          let noiseThreshold = 50; // Adjust this based on testing
          let quietFrames = 0;
          
          noiseMonitorInterval = setInterval(() => {
            analyser.getByteFrequencyData(dataArray);
            let total = 0;
            
            for (let i = 0; i < bufferLength; i++) {
              total += dataArray[i];
            }
            
            let average = total / bufferLength;
            
            if (average > noiseThreshold) {
              quietFrames = 0;
              warningCount++;
              
              if (warningCount > 3) {
                showWarning("noise");
              }
            } else {
              quietFrames++;
              if (quietFrames > 10) {
                warningCount = Math.max(0, warningCount - 1);
              }
            }
          }, 200);
        })
        .catch(err => {
          console.log("Audio monitoring not available:", err);
        });
    } catch (e) {
      console.log("AudioContext not supported:", e);
    }
  }

  // Start tab monitoring
  function startTabMonitoring() {
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) {
        showWarning("tab");
      }
    });
    
    window.addEventListener("blur", () => {
      showWarning("tab");
    });
  }

  // Show warning message
  function showWarning(type) {
    if (type === "noise") {
      document.getElementById("noise-warning").style.display = 'block';
    } else if (type === "tab") {
      document.getElementById("tab-warning").style.display = 'block';
    }
    
    // Log warning to Firebase
    db.collection("exam_warnings").add({
      type: type,
      timestamp: new Date(),
      studentName: document.getElementById("studentName").value,
      studentPhone: document.getElementById("studentPhone").value
    });
  }

  // Form submission
  document.getElementById("examForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    
    // Disable submit button to prevent multiple submissions
    const submitBtn = this.querySelector("button[type='submit']");
    submitBtn.disabled = true;
    submitBtn.textContent = "Submitting...";
    
    try {
      // Get student info
      const name = document.getElementById("studentName").value;
      const phone = document.getElementById("studentPhone").value;
      const level = document.getElementById("studentClass").value;
      
      // Collect all answers
      const answers = {};
      const radioButtons = document.querySelectorAll('input[type="radio"]:checked');
      radioButtons.forEach(radio => {
        answers[radio.name] = radio.value;
      });
      
      // Calculate score
      let score = 0;
      Object.keys(answers).forEach(q => {
        if(correctAnswers[q] && answers[q] === correctAnswers[q]) {
          score++;
        }
      });
      
      // Total number of questions
      const totalQuestions = questions.length;
      const percentage = (score/totalQuestions * 100).toFixed(2);
      
      // Save to Firebase
      await db.collection("exam_results").add({
        name: name,
        phone: phone,
        level: level,
        score: score,
        total: totalQuestions,
        percentage: percentage,
        time: new Date().toLocaleString(),
        answers: answers
      });
      
      // Store result for PDF generation
      examResult = {
        name: name,
        level: level,
        score: score,
        total: totalQuestions,
        percentage: percentage,
        date: new Date().toLocaleString()
      };
      
      // Show result
      document.getElementById("resultBox").classList.remove("hidden");
      document.getElementById("resultBox").innerHTML = `
        <h3>Exam Submitted Successfully</h3>
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Class:</strong> ${level}</p>
        <p><strong>Score:</strong> ${score} / ${totalQuestions}</p>
        <p><strong>Percentage:</strong> ${percentage}%</p>
        <p><strong>Submitted:</strong> ${new Date().toLocaleString()}</p>
      `;
      
      // Show PDF download button
      document.getElementById("pdf-download").classList.remove("hidden");
      
      // Clean up
      clearInterval(timerInterval);
      clearInterval(noiseMonitorInterval);
      if (audioContext) {
        audioContext.close();
      }
      
    } catch (error) {
      console.error("Error submitting exam: ", error);
      alert("There was an error submitting your exam. Please try again.");
      submitBtn.disabled = false;
      submitBtn.textContent = "Submit Exam";
    }
  });

  // Generate PDF with logo and results
  function generatePDF() {
    const doc = new jsPDF();
    
    // Add logo (replace with your actual logo)
    const logoUrl = 'SCHOOL.jpg';
    
    // Add content to PDF
    doc.setFontSize(20);
    doc.setTextColor(40);
    doc.text('Daughters of Divine Love Juniorate', 105, 20, { align: 'center' });
    doc.setFontSize(16);
    doc.text('Entrance Examination Result', 105, 30, { align: 'center' });
    
    // Add student info
    doc.setFontSize(12);
    doc.text(`Name: ${examResult.name}`, 20, 50);
    doc.text(`Class: ${examResult.level}`, 20, 60);
    doc.text(`Date: ${examResult.date}`, 20, 70);
    
    // Add score summary
    doc.setFontSize(14);
    doc.setTextColor(0, 100, 0);
    doc.text('Exam Results Summary', 20, 90);
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text(`Score: ${examResult.score} out of ${examResult.total}`, 20, 100);
    doc.text(`Percentage: ${examResult.percentage}%`, 20, 110);
    
    // Add grading
    doc.setFontSize(14);
    doc.setTextColor(0, 100, 0);
    doc.text('Grading', 20, 130);
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text('A: 80% - 100%', 20, 140);
    doc.text('B: 70% - 79%', 20, 150);
    doc.text('C: 60% - 69%', 20, 160);
    doc.text('D: 50% - 59%', 20, 170);
    doc.text('F: Below 50%', 20, 180);
    
    // Add footer
    doc.setFontSize(10);
    doc.setTextColor(100);
    doc.text('© 2023 Daughters of Divine Love Juniorate. All rights reserved.', 105, 280, { align: 'center' });
    
    // Save the PDF
    doc.save(`DDL_Exam_Result_${examResult.name.replace(' ', '_')}.pdf`);
  }

  // Update progress when answers change
  document.addEventListener('change', function(e) {
    if (e.target && e.target.matches('input[type="radio"]')) {
      updateProgress();
    }
  });
</script>
</body>
</html>